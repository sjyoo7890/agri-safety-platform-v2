# FR-DASH: 실시간 안전 모니터링 대시보드

## 모듈 개요
농작업장의 실시간 안전 상태를 통합 관제하는 핵심 대시보드 화면. GIS 지도, 센서 데이터, 작업자 상태, 위험 알림을 한 화면에서 모니터링한다.

## 접근 권한
- 시스템 관리자: 전체 농장 조회
- 농장 관리자: 소속 농장만 조회
- 지자체 관리자: 관할 지역 농장 조회 (읽기 전용)

## 기능 요구사항

### 3.1.1 통합 관제 화면

| ID | 요구사항 | 우선순위 | 상세 설명 |
|----|---------|---------|----------|
| FR-DASH-001 | GIS 기반 농장 지도 뷰 | 상 | Leaflet 기반 지도 위에 농작업장, 작업자, 농기계 위치를 실시간 표시. 위험 등급별 색상 코드(녹/황/주/적) 적용 |
| FR-DASH-002 | 위험 히트맵 | 상 | 농장 내 위험 등급 분포를 히트맵으로 시각화. 온도, 가스농도, 사고 빈도 등 기준 전환 가능 |
| FR-DASH-003 | 실시간 센서 상태 패널 | 상 | 온도, 습도, 가스농도, 전류/전압 등 주요 센서 데이터를 실시간 게이지/차트로 표시. 이상값 발생 시 시각적 강조 표시 |
| FR-DASH-004 | 작업자 상태 모니터 | 상 | 작업자별 위치, 심박수, 체온, 활동 상태(정상/휴식/위험)를 아이콘/카드 형태로 표시 |
| FR-DASH-005 | 최근 알림 및 E-Call 이력 | 상 | 최근 24시간 내 발생한 위험 알림 및 E-Call 이벤트를 타임라인 형식으로 표시. 클릭 시 상세 정보 팝업 |
| FR-DASH-006 | CCTV 영상 연동 | 중 | 농작업장 CCTV 영상을 팝업 또는 PIP(Picture-in-Picture) 형태로 실시간 스트리밍. AI 분석 결과(바운딩박스 등) 오버레이 |
| FR-DASH-007 | 다중 농장 관제 | 중 | 지자체/기관 관리자용 - 복수 농장의 위험 현황을 한 화면에서 비교 조회 가능 |

## 화면 구성 가이드

### 통합 관제 대시보드 레이아웃
```
┌──────────────────────────────────────────────────────┐
│ 헤더: 로고, 현재 농장 선택, 알림 아이콘, 사용자 메뉴   │
├────────────────────────┬─────────────────────────────┤
│                        │  센서 상태 패널              │
│                        │  ┌─────┐ ┌─────┐ ┌─────┐   │
│   GIS 지도             │  │온도  │ │습도  │ │가스  │   │
│   (Leaflet)            │  │게이지│ │게이지│ │게이지│   │
│   - 작업자 마커        │  └─────┘ └─────┘ └─────┘   │
│   - 농기계 마커        ├─────────────────────────────┤
│   - 위험 히트맵        │  작업자 상태 목록             │
│   - 센서 위치          │  [카드] 이름 | 상태 | 심박    │
│                        │  [카드] 이름 | 상태 | 심박    │
│                        │  [카드] 이름 | 상태 | 심박    │
├────────────────────────┴─────────────────────────────┤
│  최근 알림 타임라인 (최근 24시간)                       │
│  🔴 10:32 - 작업자A 추락 위험 감지 | E-Call 발동       │
│  🟠 10:28 - 비닐하우스B 온도 38℃ 초과                 │
│  🟡 10:15 - 트랙터C 경사각 15° 주의                   │
└──────────────────────────────────────────────────────┘
```

## 관련 API
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/v1/dashboard/overview` | 통합 대시보드 요약 데이터 (위험현황, 작업자수, 알림수) |
| GET | `/api/v1/dashboard/map` | GIS 지도 데이터 (작업자/농기계/센서 위치 및 상태) |
| WS | `/ws/dashboard` | 실시간 데이터 스트림 (WebSocket) |

## 기술 구현 힌트
- **GIS 지도**: `react-leaflet` + OpenStreetMap 타일. Leaflet.heat 플러그인으로 히트맵
- **실시간 갱신**: WebSocket 연결로 5초 이내 데이터 갱신. 연결 끊김 시 자동 재연결
- **센서 게이지**: Recharts의 RadialBarChart 또는 커스텀 SVG 게이지
- **작업자 카드**: 위험 등급별 보더 색상, 클릭 시 FR-WKR 작업자 상세 페이지로 이동
- **반응형**: 태블릿(1024px+)에서 지도와 패널 2컬럼, 모바일은 탭 기반 전환
