# FR-MOB: 작업자용 모바일 웹

## 모듈 개요
현장 작업자(주로 고령 농업인)가 사용하는 모바일 웹 인터페이스. 실버 친화적(Silver-Friendly) UI/UX를 적용하여, 큰 글씨, 고대비, 단순한 터치 조작, 음성 안내(TTS)를 제공한다.

## 접근 권한
- 작업자: 본인 데이터 조회, E-Call 발동, 알림 수신

## 설계 원칙 (실버 친화적 UI)
1. **글자 크기**: 최소 18pt (본문), 24pt (제목/상태 표시)
2. **고대비 색상**: 배경 흰색, 텍스트 검정, 위험 등급은 큰 면적 색상 블록
3. **터치 영역**: 최소 48×48px (iOS/Android 가이드라인의 1.5배)
4. **조작 최소화**: 한 화면에 최대 3~4개 액션만 표시
5. **음성 안내**: 위험 알림 시 자동 TTS 재생
6. **단순 네비게이션**: 하단 탭 3개 이내 (홈/알림/내정보)

## 기능 요구사항

| ID | 요구사항 | 우선순위 | 상세 설명 |
|----|---------|---------|----------|
| FR-MOB-001 | 현재 위험 상태 표시 | 상 | 현재 위험 등급을 큰 아이콘과 색상으로 직관적 표시. 정상(초록)/주의(노랑)/경고(주황)/위험(빨강) |
| FR-MOB-002 | 위험 알림 수신 | 상 | 소리/진동/팝업 알림 수신. 위험 유형과 구체적 행동 지침(감소대책) 텍스트 표시 |
| FR-MOB-003 | 긴급 호출(E-Call) | 상 | 원터치 E-Call 버튼. 누르면 GPS 위치 포함 긴급 메시지를 관리자/보호자/119에 자동 전송 |
| FR-MOB-004 | 개인 건강 데이터 조회 | 중 | 오늘의 심박수, 체온, 누적 작업시간, 열 스트레스 지수(PSI) 확인 |
| FR-MOB-005 | 음성 안내(TTS) | 중 | 위험 알림 및 행동 지침을 음성으로 안내하는 TTS(Text-to-Speech) 기능 |
| FR-MOB-006 | 큰 글씨/고대비 모드 | 상 | 글자 크기 최소 18pt 이상, 고대비 색상 적용. 복잡한 터치 조작 최소화 |

## 화면 구성 가이드

### 메인 화면 (홈)
```
┌────────────────────────┐
│ 🌾 농업안전           ⚙ │
├────────────────────────┤
│                        │
│   ┌──────────────────┐ │
│   │                  │ │
│   │   🟢 안 전       │ │
│   │                  │ │
│   │   현재 위험 없음   │ │
│   │                  │ │
│   └──────────────────┘ │
│        (큰 상태 블록)    │
│                        │
│   ❤ 심박: 72 bpm      │
│   🌡 체온: 36.5℃      │
│   ⏱ 작업: 2시간 30분   │
│                        │
│ ┌──────────────────────┐│
│ │                      ││
│ │  🆘 긴급 호출       ││
│ │  (E-Call)            ││
│ │                      ││
│ └──────────────────────┘│
│    (큰 빨간 버튼)       │
│                        │
├────┬──────────┬────────┤
│ 🏠 │  🔔 알림  │ 👤 내정보│
│ 홈  │  (2)     │        │
└────┴──────────┴────────┘
```

### 위험 알림 팝업
```
┌────────────────────────┐
│                        │
│   🔴 경 고 !          │
│                        │
│   온열질환 위험         │
│                        │
│   ┌──────────────────┐ │
│   │ 🔊 "현재 작업 환경│ │
│   │ 온도가 높습니다.  │ │
│   │ 즉시 그늘로       │ │
│   │ 이동하여 휴식     │ │
│   │ 하십시오."        │ │
│   └──────────────────┘ │
│    (TTS 자동 재생)      │
│                        │
│   행동 지침:           │
│   ① 즉시 그늘 이동    │
│   ② 물 섭취           │
│   ③ 조끼 냉각팩 활성화 │
│                        │
│ ┌──────────────────────┐│
│ │    확 인             ││
│ └──────────────────────┘│
│                        │
│ ┌──────────────────────┐│
│ │  🆘 긴급 호출       ││
│ └──────────────────────┘│
└────────────────────────┘
```

### E-Call 발동 화면
```
┌────────────────────────┐
│                        │
│   🆘 긴급 호출 중...   │
│                        │
│   📍 위치 전송 완료     │
│   GPS: 35.1234, 127.5678│
│                        │
│   📨 발송 대상:        │
│   ✅ 관리자 (박관리)    │
│   ✅ 보호자 (홍보호)    │
│   ⏳ 119 (에스컬레이션) │
│                        │
│   ⏱ 2분 30초 경과      │
│                        │
│ ┌──────────────────────┐│
│ │    취 소             ││
│ └──────────────────────┘│
│ (30초 이내만 취소 가능)  │
└────────────────────────┘
```

## 관련 API
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/v1/mobile/status` | 현재 위험 상태 + 생체신호 요약 |
| GET | `/api/v1/mobile/alerts` | 본인 알림 목록 |
| PUT | `/api/v1/mobile/alerts/{id}/acknowledge` | 알림 확인 |
| POST | `/api/v1/ecall` | E-Call 발동 |
| DELETE | `/api/v1/ecall/{id}` | E-Call 취소 (30초 이내) |
| GET | `/api/v1/mobile/health` | 오늘의 건강 데이터 요약 |

## 기술 구현 힌트
- **반응형**: 모바일 퍼스트 디자인. 320px~428px 뷰포트 최적화
- **PWA**: Service Worker 등록하여 오프라인 기본 UI 표시 + FCM 푸시 알림 수신
- **TTS**: Web Speech API (`speechSynthesis`) 사용. 한국어 음성. 위험 알림 시 자동 재생
- **E-Call 버튼**: 의도치 않은 터치 방지 → 1.5초 이상 롱프레스 또는 확인 다이얼로그
- **큰 글씨 모드**: CSS 변수로 폰트 크기 제어. 설정에서 '큰 글씨' 토글
- **GPS**: Geolocation API로 현재 위치 취득. E-Call 시 위도/경도 첨부
- **위험 상태 블록**: 화면의 40% 이상 차지하는 큰 색상 블록. 한눈에 상태 파악 가능
